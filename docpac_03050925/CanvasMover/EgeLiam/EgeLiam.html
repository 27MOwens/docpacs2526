<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CanvasMover</title>
    <div>
        <button id="btnW">W</button>
        <button id="btnA">A</button>
        <button id="btnS">S</button>
        <button id="btnD">D</button>
    </div>
</head>

<body>

    <canvas id="canvas1" width="800" height="600" style="border: 2px solid black;"></canvas>
    <script>
        const canvas = document.getElementById("canvas1");
        const ctx = canvas.getContext("2d");

        const guy = {}
        guy.x = 0;
        guy.y = 0;
        guy.width = 180;
        guy.height = 180;
        guy.image = new Image();
        guy.image.src = "OIP.webp"
        guy.speed = 2;

        const buttons = {
            "W": document.getElementById("btnW"),
            "A": document.getElementById("btnA"),
            "S": document.getElementById("btnS"),
            "D": document.getElementById("btnD")
        };

        function highlightButton(key) {
            if (buttons[key]) {
                buttons[key].classList.add("highlight");
            }
        }

        function unhighlightButton(key) {
            if (buttons[key]) {
                buttons[key].classList.remove("highlight");
            }
        }

        document.addEventListener("keydown", function (event) {
            const key = event.key.toUpperCase();
            highlightButton(key);

			// The instructions say to handle the player movement in the update loop,
			// not in the key press handler.
			// Did you not notice that the image only moved once per keypress?
			// all of these if's needed to be in update()
			
			// It looks like you relied quite heavily on AI. Please make sure
			// you read and understand the instructions, and never use any AI
			// code that you don't completely understand.

            if (key === "ARROWUP" || key === "W") {
                guy.y -= guy.speed;
            } else if (key === "ARROWDOWN" || key === "S") {   
                guy.y += guy.speed;
            } else if (key === "ARROWLEFT" || key === "A") {
                guy.x -= guy.speed;
            } else if (key === "ARROWRIGHT" || key === "D") {
                guy.x += guy.speed;
                console.log("right");
            }

            if (guy.x < 0) {
                guy.x = 0;
            }
            if (guy.y < 0) {
                guy.y = 0;
            }
            if (guy.x + guy.width > canvas.width) {
                guy.x = canvas.width - guy.width;
            }
            if (guy.y + guy.height > canvas.height) {
                guy.y = canvas.height - guy.height;
            }
        });

        document.addEventListener("keyup", function (event) {
            const key = event.key.toUpperCase();
            unhighlightButton(key);
        });

        function update() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.drawImage(guy.image, guy.x, guy.y, guy.width, guy.height);
            ctx.fillText("keyboard", 0, 10);
            ctx.fillText(+ guy.x + "," + guy.y, 0, 30);
            requestAnimationFrame(update);
        }
        requestAnimationFrame(update);
    </script>
    <style>
        .highlight {
            background-color: yellow;
        }
    </style>

    </script>
</body>

</html>